#include <stdio.h>
#include "Sbox.h"
#include "KeyExtension.h"
#include "operation.h"

//202100460140
unsigned char msg[16] = {
	0x32,0x30,0x32,0x31,0x30,0x30,0x34,0x36,0x30,0x31,0x34,0x30,0x00,0x00,0x00,0x00
};
unsigned char key[16] = {
	0x32,0x30,0x32,0x31,0x30,0x30,0x34,0x36,0x30,0x31,0x34,0x30,0x00,0x00,0x00,0x00
};

//202100460058
//unsigned char msg[16] = {
//	0x32,0x30,0x32,0x31,0x30,0x30,0x34,0x36,0x30,0x30,0x35,0x38,0x00,0x00,0x00,0x00
//};
//unsigned char key[16] = {
//	0x32,0x30,0x32,0x31,0x30,0x30,0x34,0x36,0x30,0x30,0x35,0x38,0x00,0x00,0x00,0x00
//};


unsigned char cipher[16];

void my_printf(unsigned char output[16]) {
	for (int i = 0; i < 16; i++) {
		printf("%x ", output[i]);
	}
}

void encrypt(unsigned char * msg, unsigned char * key) {
	//ÃÜÔ¿ÍØÕ¹
	key_extension(key);
	//³õÊ¼ÂÖÃÜÔ¿Ïà¼Ó
	xor128(msg, keys[0], cipher);
	//9ÂÖ¼ÓÃÜ
	for (int i = 1; i < 10; i++) {
		substitute(cipher);
		shift_row(cipher);
		mix_columns(cipher);
		xor128(cipher, keys[4 * i], cipher);
	}
	//µÚ10ÂÖ¼ÓÃÜ
	substitute(cipher);
	shift_row(cipher);
	xor128(cipher, keys[40], cipher);
	//´òÓ¡ÃÜÔ¿
	my_printf(cipher);
}


int main() {	
	encrypt(msg, key);
	
}